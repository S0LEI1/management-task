"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.requirePermission = void 0;
const bad_request_error_1 = require("../errors/bad-request-error");
const requirePermission = (permissions) => {
    return (req, res, next) => {
        const currentPermissions = req.currentUser.permissions;
        const isIncluded = permissions.every((per) => currentPermissions.includes(per));
        if (isIncluded === false)
            throw new bad_request_error_1.BadRequestError(`Required: ${permissions} permission`);
        next();
    };
};
exports.requirePermission = requirePermission;
